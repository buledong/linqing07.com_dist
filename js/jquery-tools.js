$.Class=function(n){var t=function(){function n(n){return this.init.apply(this,n)}var t=arguments.callee,e=t.prototype.init;return n.prototype=t.prototype,n.prototype.init=function(){var n=arguments;return 1===n.length&&n[0]instanceof t?this:(e&&e.apply(this,n),this)},n.constructor=t,new n(arguments)};t.extend=$.Class.extend,"function"==typeof n&&(n=n()),n=n||{};for(var e in n)t.prototype[e]=n[e];return t},$.Class.extend=function(n){"function"==typeof n&&(n=n());var t=this.prototype,e=$.extend({},t);for(var r in n)e[r]="function"==typeof n[r]&&"function"==typeof t[r]?function(n,e){return function(){var r=this._super;this._super=t[n];var i=e.apply(this,arguments);return this._super=r,i}}(r,n[r]):n[r];var i=pp.Class(e);return i},$.fn.delegates=function(n){el=$(this[0]);for(var t in n){var e=n[t];if("function"==typeof e){var r={};r.click=e,e=r}for(var i in e)el.delegate(t,i,e[i])}return this},$.getPromise=function(n,t){if(n&&"function"==typeof n.resolve)return n;var e=$.Deferred();return setTimeout(function(){t?e.reject(n):e.resolve(n)},0),e},$.queryUrl=function(n,t){n=n||"",n=n.replace(/^[^?=]*\?/gi,"").split("#")[0];var e={};return n.replace(/(^|&)([^&=]+)=([^&]*)/g,function(n,t,r,i){try{r=decodeURIComponent(r)}catch(o){}try{i=decodeURIComponent(i)}catch(o){}r in e?e[r]instanceof Array?e[r].push(i):e[r]=[e[r],i]:e[r]=/\[\]$/.test(r)?[i]:i}),t?e[t]:e},$.encodeURIJson=function(n){var t=[];for(var e in n)if(null!=n[e])if(n[e]instanceof Array)for(var r=0;r<n[e].length;r++)t.push(encodeURIComponent(e)+"="+encodeURIComponent(n[e][r]));else t.push(e+"="+encodeURIComponent(n[e]).replace(/\(/g,"%28").replace(/\)/g,"%29"));return t.join("&")},$.encode4Html=function(n){var t=document.createElement("pre"),e=document.createTextNode(n);return t.appendChild(e),t.innerHTML};var comReg=/<!--!\$([\w]+)-->/g;$.tpl=function(n,t){return n=$.tmpl(n,t),n=n.replace(comReg,function(n,e){var r=$("#"+e).html();return $.tpl(r,t)})},$.changeHash=function(n){var t=(location.hash||"#").substr(1),e=$.queryUrl(t);if(!n)return e;n=n||{},e=$.extend(e,n);for(var r in e)null===e[r]&&delete e[r];var t=$.encodeURIJson(e);return location.hash=t,e},$.initHash=function(){var n=(location.hash||"#").substr(1),t=$.queryUrl(n);for(var e in t){var r=t[e],i='[data-name="'+e+'"]';$.isArray(r)||(r=[r]),$(i).each(function(){var n=this.tagName.toLowerCase(),t=["input","select","textarea"];if(-1===$.inArray(n,t))return!1;var e=r.shift();return void 0===e?!1:"input"==n&&"checkbox"==this.type&&e==this.value?(this.checked=!0,!0):void(this.value=e)})}},$.tmpl=function(){var n={},t="sArrCMX",e=t+'.push("',r={"=":{tagG:"=",isBgn:1,isEnd:1,sBgn:'",$.encode4Html(',sEnd:'),"'},js:{tagG:"js",isBgn:1,isEnd:1,sBgn:'");',sEnd:";"+e},js:{tagG:"js",isBgn:1,isEnd:1,sBgn:'");',sEnd:";"+e},"if":{tagG:"if",isBgn:1,rlt:1,sBgn:'");if',sEnd:"{"+e},elseif:{tagG:"if",cond:1,rlt:1,sBgn:'");} else if',sEnd:"{"+e},"else":{tagG:"if",cond:1,rlt:2,sEnd:'");}else{'+e},"/if":{tagG:"if",isEnd:1,sEnd:'");}'+e},"for":{tagG:"for",isBgn:1,rlt:1,sBgn:'");for',sEnd:"{"+e},"/for":{tagG:"for",isEnd:1,sEnd:'");}'+e},"while":{tagG:"while",isBgn:1,rlt:1,sBgn:'");while',sEnd:"{"+e},"/while":{tagG:"while",isEnd:1,sEnd:'");}'+e}};return function(i,o){var s=n[i];if(!s){for(var a=-1,c=[],u=[[/\{strip\}([\s\S]*?)\{\/strip\}/g,function(n,t){return t.replace(/[\r\n]\s*\}/g," }").replace(/[\r\n]\s*/g,"")}],[/\\/g,"\\\\"],[/"/g,'\\"'],[/\r/g,"\\r"],[/\n/g,"\\n"],[/\{[\s\S]*?\S\}/g,function(n){n=n.substr(1,n.length-2);for(var t=0;t<g.length;t++)n=n.replace(g[t][0],g[t][1]);var e=n;/^(=|.\w+)/.test(e)&&(e=RegExp.$1);var i=r[e];if(i){if(i.isBgn)var o=c[++a]={tagG:i.tagG,rlt:i.rlt};if(i.isEnd){if(0>a)throw new Error("Unexpected Tag: "+n);if(o=c[a--],o.tagG!=i.tagG)throw new Error("Unmatch Tags: "+o.tagG+"--"+e)}else if(!i.isBgn){if(0>a)throw new Error("Unexpected Tag:"+n);if(o=c[a],o.tagG!=i.tagG)throw new Error("Unmatch Tags: "+o.tagG+"--"+e);if(i.cond&&!(i.cond&o.rlt))throw new Error("Unexpected Tag: "+e);o.rlt=i.rlt}return(i.sBgn||"")+n.substr(e.length)+(i.sEnd||"")}return'",('+n+'),"'}]],g=[[/\\n/g,"\n"],[/\\r/g,"\r"],[/\\"/g,'"'],[/\\\\/g,"\\"],[/\$(\w+)/g,'opts["$1"]'],[/print\(/g,t+".push("]],f=0;f<u.length;f++)i=i.replace(u[f][0],u[f][1]);if(a>=0)throw new Error("Lose end Tag: "+c[a].tagG);i=i.replace(/##7b/g,"{").replace(/##7d/g,"}").replace(/##23/g,"#"),i="var "+t+"=[];"+e+i+'");return '+t+'.join("");',n[i]=s=new Function("opts",i)}return arguments.length>1?s(o):s}}();